<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <!-- <link href="./script.js"> -->
</head>

<body>
    <div id="loadingContainer">
        <div id="progressBar">
            <div id="progress">
                <img class="loadingSnakes" src="./image/loading-snake.svg" alt="">
            </div>
        </div>
        <span id="progressText">0%</span>
    </div>

    <div class="card-position">
        <div class="fullcard">
            <div class="page-1">
                <div class="front"></div>
                <div class="back"></div>

            </div>

            <div class="page-2">

                <div class="front">

                    <div class="page2Zoom" id="lanternpage">
                        <!-- 內文 -->
                        <img class="ilineLogo" src="./image/iline-logo.svg" alt="">
                        <p class="contentText">
                            親愛的藥師夥伴，<br>感謝您長期的支持與信任！<br><br>

                            我們即將推出全新的 iLINE 系統，助您更輕鬆地管理顧客關係，提升服務效率。<br>
                            透過 iLINE，您能快速掌握顧客消費喜好，並提供慢籤領藥功能，貼心提醒顧客領藥。<br>
                            此外，團購功能，幫助您靈活應對不同顧客的購物需求。<br>
                            期待 iLINE 為您帶來更便捷的管理體驗，<br>協助您提供更優質的社區服務！<br>
                        </p>

                        <!-- 團購 -->
                        <button id="iline-shop" class="ilineContent" onclick="showPopShop()">
                            <span id="lightShop" class="lantern-light"></span>
                        </button>
                        <div id="popShop" class="pop">
                            <img class="pop-img" src="./image/loading-snake.svg" alt="">
                            <p>內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字內容測試大約100字
                            </p>
                            <button id="close-btn" onclick="hidePop()"></button>
                        </div>

                        <!-- 會員 -->
                        <button id="iline-member" class="ilineContent" onclick="showPopMember()">
                            <span id="lightMember" class="lantern-light"></span>
                        </button>
                        <div id="popMember" class="pop">
                            <img class="pop-img" src="./image/loading-snake.svg" alt="">
                            <p>membermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermembermember
                            </p>
                            <button id="close-btn" onclick="hidePop()"></button>
                        </div>

                        <!-- 慢籤 -->
                        <button id="iline-medicine" class="ilineContent" onclick="showPopMedicine()">
                            <span id="lightMedicine" class="lantern-light"></span>
                        </button>
                        <div id="popMedicine" class="pop">
                            <img class="pop-img" src="./image/loading-snake.svg" alt="">
                            <p>medicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicinemedicine
                            </p>
                            <button id="close-btn" onclick="hidePop()"></button>
                        </div>


                        <!-- 提示動畫 -->
                        <div class="tips">
                            <div class="needToClick needToClick-1">
                                <div class="ripples">
                                    <span class="circle-1"></span>
                                    <span class="circle-2"></span>
                                    <span class="circle-3"></span>
                                </div>
                                <img class="hand" src="./image/pan_tool_alt.svg" alt="">
                            </div>

                            <div class="needToClick needToClick-2">
                                <div class="ripples">
                                    <span class="circle-1"></span>
                                    <span class="circle-2"></span>
                                    <span class="circle-3"></span>
                                </div>
                                <img class="hand" src="./image/pan_tool_alt.svg" alt="">
                            </div>

                            <div class="needToClick needToClick-3">
                                <div class="ripples">
                                    <span class="circle-1"></span>
                                    <span class="circle-2"></span>
                                    <span class="circle-3"></span>
                                </div>
                                <img class="hand" src="./image/pan_tool_alt.svg" alt="">
                            </div>

                        </div>

                    </div>

                </div>
                <div class="back"></div>
            </div>

            <div class="page-3">
                <div class="front">
                    <div class="page2Zoom" id="calenderpage">
                        <div class="calender">
                            <img class="calenderYear" src="./image/calender/calender-year.svg" alt="">
                            <img class="calenderDay" src="./image/calender/calender-day.svg" alt="">
                            <img class="calenderClouldline" id="calenderClouldline-1"
                                src="./image/calender/calender-cloudline.svg" alt="">
                            <img class="calenderClouldline" id="calenderClouldline-2"
                                src="./image/calender/calender-cloudline.svg" alt="">
                            <img class="calenderCloulddot" id="calenderCloulddot-1"
                                src="./image/calender/calender-cloulddot.svg" alt="">
                            <img class="calenderCloulddot" id="calenderCloulddot-2"
                                src="./image/calender/calender-cloulddot.svg" alt="">
                            <img class="calenderGreenflower" id="calenderGreenflower-1"
                                src="./image/calender/calender-greenflower.svg" alt="">
                            <img class="calenderGreenflower" id="calenderGreenflower-2"
                                src="./image/calender/calender-greenflower.svg" alt="">
                            <img class="calenderRedflower" id="calenderRedflower-1"
                                src="./image/calender/calender-redflower.svg" alt="">
                            <img class="calenderRedflower" id="calenderRedflower-2"
                                src="./image/calender/calender-redflower.svg" alt="">
                        </div>

                        <div class="claenderText">
                            <h4>1/25(六)至2/2(日)年節期間 服務說明</h4>
                            <span class="clip">
                                <div class="content">
                                    <p>1/25-1/27仍提供電話客服服務，專線忙線中，可利用官方LINE的智慧客服填寫表單，或於語音信箱中，留下您的</p>
                                    <p>「寶號」、「聯絡電話」、「事項」</p>
                                    <p>值班人員將與您聯繫。</p>
                                    <p>此外，年節期間無法提供到府服務，不變之處請見諒。</p>
                                </div>
                            </span>

                        </div>

                    </div>
                </div>
                <div class="back"></div>
            </div>

            <div class="page-4">
                <div class="front">
                    <div class="page2Zoom" id="contactpage">

                        <div class="companyLogo">
                            <img class="contactcfan" src="./image/contact/contact-companylogo.svg" alt="">
                            <img class="contactcloud-1" src="./image/contact/contact-greencloud.svg" alt="">
                            <img class="contactcloud-2" src="./image/contact/contact-greencloud.svg" alt="">
                        </div>

                        <h4>樺穎資訊科技顧問有限公司</h4>

                        <p>
                            24248新北市新莊區中泰街65-1號1樓<br>
                            TEL：02-29989420<br>
                            FAX：02-2998-9435<br>
                            假日服務電話：0918-808-588<br>
                            統一編號：28534765<br>
                        </p>

                        <div class="contactButton">
                            <button class="conpanyWeb">官方網頁</button>
                            <button class="conpanyLine">官方LINE</button>
                        </div>

                        <div class="contactTriangle">
                            <img class="darkredtriangle-1" src="./image/contact/contact-darkredtriangle.svg" alt="">
                            <img class="darkredtriangle-2" src="./image/contact/contact-darkredtriangle.svg" alt="">
                            <img class="greentriangle" src="./image/contact/contact-greentriangle.svg" alt="">
                            <img class="redtriangle" src="./image/contact/contact-redtriangle.svg" alt="">
                        </div>

                        <img class="contactMoney-1" src="./image/contact/contact-money.svg" alt="">
                        <img class="contactMoney-2" src="./image/contact/contact-money.svg" alt="">
                        <img class="contactYellowflower" src="./image/contact/contact-yellowflower.svg" alt="">
                        <img class="contactDarkredflower-1" src="./image/contact/contact-darkredflower.svg" alt="">
                        <img class="contactDarkredflower-2" src="./image/contact/contact-darkredflower.svg" alt="">
                        <img class="contactGreenflower-1" src="./image/calender/calender-greenflower.svg" alt="">
                        <img class="contactGreenflower-2" src="./image/calender/calender-greenflower.svg" alt="">
                        <img class="contactRedflower" src="./image/calender/calender-redflower.svg" alt="">

                    </div>
                </div>
                <div class="back"></div>
            </div>
        </div>
    </div>






    <script>
        // pop up

        const ilineContent = document.querySelectorAll('.ilineContent');

        const pops = document.querySelectorAll('.pop');
        const popShop = document.querySelector('#popShop');
        const popMember = document.querySelector('#popMember');
        const popMedicine = document.querySelector('#popMedicine');

        const lights = document.querySelectorAll('.lantern-light');
        const lightShop = document.querySelector('#lightShop');
        const lightMember = document.querySelector('#lightMember');
        const lightMedicine = document.querySelector('#lightMedicine');


        // 團購
        function showPopShop() {
            popShop.classList.add('show');
            lightShop.style.opacity = '100%';

            // 禁用按鈕
            ilineContent.forEach(button => {
                button.style.pointerEvents = 'none';
            });
        }


        // 會員
        function showPopMember() {
            popMember.classList.add('show');
            lightMember.style.opacity = '100%';

            // 禁用按鈕
            ilineContent.forEach(button => {
                button.style.pointerEvents = 'none';
            });
        }

        // 領藥
        function showPopMedicine() {
            popMedicine.classList.add('show');
            lightMedicine.style.opacity = '100%';

            // 禁用按鈕
            ilineContent.forEach(button => {
                button.style.pointerEvents = 'none';
            });
        }


        // 隱藏彈窗
        function hidePop() {
            pops.forEach(pop => {
                pop.classList.remove('show');
            });

            lights.forEach(light => {
                light.style.opacity = '30%';
            });

            // 啟用按鈕
            ilineContent.forEach(button => {
                button.style.pointerEvents = 'auto';
            });
        }


        // 燈籠頁面顯示動畫
        const lanternpage = document.getElementById("lanternpage");


        // tips 提示動畫
        const tips = document.querySelector('.tips');



        // 燈籠下墜
        const lanterns = document.querySelectorAll('.ilineContent');

        function showLantern() {
            lanterns.forEach(lantern => {
                lantern.style.display = "block";
            });
        }

        function closeLantern() {
            lanterns.forEach(lantern => {
                lantern.style.display = "none";
            });
        }


        // 第三頁（月曆）
        const calenderpage = document.getElementById("calenderpage");
        // 第四頁（聯絡）
        const contactpage = document.getElementById("contactpage");



        // 翻頁動畫
        const page1 = document.querySelector('.page-1');
        const page2 = document.querySelector('.page-2');
        const page3 = document.querySelector('.page-3');
        const page4 = document.querySelector('.page-4');
        const fullcard = document.querySelector('.fullcard');
        let fullcardWidth

        let clicknumber = 0

        document.addEventListener("DOMContentLoaded", function () {
            const vhValue = window.innerHeight; // 獲取 100vh 的實際數值
            const vwValue = window.innerWidth; // 獲取 100vw 的實際數值

            // 計算 fullcardWidth
            if (vhValue > vwValue) {
                fullcardWidth = vwValue * 0.95; // 如果 vhValue 大於 vwValue，設置為 vwValue 的 80%
            } else {
                fullcardWidth = vhValue * 0.7; // 如果 vwValue 大於 vhValue，設置為 vhValue 的 80%
            }

            document.documentElement.style.setProperty('--fullcard-width', `${fullcardWidth}px`);

            const borderRadiusValue = fullcardWidth * 0.04;
            document.documentElement.style.setProperty('--border-radius', borderRadiusValue + 'px');

            const page2Zoom = fullcardWidth / 653.8;
            document.documentElement.style.setProperty('--page2Zoom', page2Zoom);
        });

        // const fullcardTureWidth = fullcard.clientWidth;

        function translateCard(translatePx) {
            fullcard.style.transform = `translateX(${translatePx}px)`;
        }
        function addFlip(page, rotationAngle) {
            page.classList.add('changePage');
            page.style.transform = `rotateY(${rotationAngle}deg)`;
        }

        function removeFlip(page) {
            page.classList.remove('changePage');
            page.style.transform = '';  // 清除自定義的旋轉角度
        }

        // 根據 clicknumber 值來控制 class
        // 首先移除所有的 changePage class
        removeFlip(page1);
        removeFlip(page2);
        removeFlip(page3);
        removeFlip(page4);


        // document.addEventListener("click", function (event) {
        //     // 獲取螢幕的寬度
        //     const screenWidth = window.innerWidth;

        //     // 檢查點擊是否在螢幕的右半邊
        //     if (event.clientX > screenWidth / 2 && clicknumber < 3) {
        //         // 如果點擊在右半邊且 clicknumber 小於 5，讓 clicknumber 加 1
        //         clicknumber += 1;
        //         console.log("點擊在右半邊，clicknumber:", clicknumber);
        //     }
        //     // 檢查點擊是否在螢幕的左半邊，且 clicknumber 大於 0
        //     else if (event.clientX <= screenWidth / 2 && clicknumber > 0) {
        //         // 如果點擊在左半邊且 clicknumber 大於 0，讓 clicknumber 減 1
        //         clicknumber -= 1;
        //         console.log("點擊在左半邊，clicknumber:", clicknumber);
        //     }

        //     // 再依據 clicknumber 增加對應的 class
        //     switch (clicknumber) {
        //         case 0:
        //             removeFlip(page1);
        //             removeFlip(page2);
        //             removeFlip(page3);
        //             break;
        //         case 1:
        //             addFlip(page1, -130, 0);
        //             removeFlip(page2);
        //             removeFlip(page3);
        //             break;
        //         case 2:
        //             addFlip(page1, -130, 0);
        //             addFlip(page2, -130, 0);
        //             removeFlip(page3);
        //             translateCard(0)
        //             break;
        //         case 3:
        //             addFlip(page1, -180);
        //             addFlip(page2, -180);
        //             addFlip(page3, -180);
        //             addFlip(page3);
        //             translateCard(fullcardWidth)
        //             break;
        //     }
        // });

        let isDragging = false;
        let startX = 0;

        function handleDragStart(event) {
            isDragging = true;

            // 如果是觸控事件，取得觸控的 X 座標
            if (event.touches) {
                startX = event.touches[0].clientX;
            } else {
                startX = event.clientX;
            }
        }

        function handleDragMove(event) {
            if (!isDragging) return;

            let currentX;

            // 如果是觸控事件，取得觸控的 X 座標
            if (event.touches) {
                currentX = event.touches[0].clientX;
            } else {
                currentX = event.clientX;
            }

            const diffX = currentX - startX;

            // 判斷拖曳距離超過一定值
            if (diffX < -100) { // 左側拖曳
                clicknumber = Math.min(clicknumber + 1, 4); // 增加 clicknumber
                // console.log("點擊在左半邊，clicknumber:", clicknumber);
                isDragging = false; // 停止拖曳
            } else if (diffX > 100) { // 右側拖曳
                clicknumber = Math.max(clicknumber - 1, 0); // 減少 clicknumber
                // console.log("點擊在右半邊，clicknumber:", clicknumber);
                isDragging = false; // 停止拖曳
            }
        }

        function handleDragEnd() {
            // 根據 clicknumber 的值進行對應的操作
            switch (clicknumber) {
                case 0:
                    removeFlip(page1);
                    removeFlip(page2);
                    removeFlip(page3);
                    removeFlip(page4);
                    closeLantern()
                    lanternpage.style.display = "none";
                    break;
                case 1:
                    addFlip(page1, -130, 0);
                    removeFlip(page2);
                    removeFlip(page3);
                    removeFlip(page4);
                    hidePop()
                    calenderpage.style.display = "none";
                    lanternpage.style.display = "flex";
                    showLantern()
                    break;
                case 2:
                    addFlip(page1, -130, 0);
                    addFlip(page2, -130, 0);
                    removeFlip(page3);
                    removeFlip(page4);
                    closeLantern()
                    calenderpage.style.display = "flex";
                    lanternpage.style.display = "none";
                    contactpage.style.display = "none";
                    break;
                case 3:
                    addFlip(page1, -130, 0);
                    addFlip(page2, -130, 0);
                    addFlip(page3, -130, 0);
                    removeFlip(page4);
                    calenderpage.style.display = "none";
                    contactpage.style.display = "flex";
                    translateCard(0);
                    break;
                case 4:
                    addFlip(page1, -180);
                    addFlip(page2, -180);
                    addFlip(page3, -180);
                    addFlip(page4, -180);
                    translateCard(fullcardWidth);
                    contactpage.style.display = "none";
                    
                    break;
            }

            // 清理事件
            isDragging = false; // 停止拖曳
        }

        document.addEventListener("mousedown", handleDragStart);
        document.addEventListener("mousemove", handleDragMove);
        document.addEventListener("mouseup", handleDragEnd);

        // 觸控事件
        document.addEventListener("touchstart", handleDragStart);
        document.addEventListener("touchmove", handleDragMove);
        document.addEventListener("touchend", handleDragEnd);







        //  過場動畫
        let currentProgress = 0;
        const progressBar = document.getElementById("progress");
        const progressText = document.getElementById("progressText");
        const minDisplayTime = 2000; // 最少顯示 2 秒
        const startTime = Date.now(); // 記錄開始時間

        // 模擬進度遞增函數
        const simulateProgress = () => {
            if (currentProgress < 99) { // 頁面未完全加載時增長至 90%
                currentProgress += 1; // 每次增加固定值
                progressBar.style.width = currentProgress + "%";
                progressText.textContent = Math.floor(currentProgress) + "%";
                setTimeout(simulateProgress, 25); // 每 50 毫秒更新一次
            }
        };

        // 啟動模擬進度
        simulateProgress();

        // 當所有資源完全加載後
        window.onload = () => {
            const elapsedTime = Date.now() - startTime;
            const remainingTime = minDisplayTime - elapsedTime; // 計算需要延遲的時間

            // 確保最少顯示 2 秒再進行最終進度更新
            setTimeout(() => {
                currentProgress = 100;
                progressBar.style.width = "100%";
                progressText.textContent = "100%";

                // 隱藏加載動畫並顯示主頁面
                setTimeout(() => {
                    document.getElementById("loadingContainer").style.opacity = "0";
                    setTimeout(() => {
                        document.getElementById("loadingContainer").style.display = "none";
                    }, 500); // 過渡時間
                }, 500);
            }, Math.max(remainingTime, 0)); // 確保至少 2 秒的顯示時間
        };


    </script>
</body>

</html>